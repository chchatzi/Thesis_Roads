from geomet import wkt
import json
import math
from shapely.geometry import LineString
from shapely.geometry import Polygon
from shapely.geometry import MultiLineString
from shapely.geometry import Point

#fit big centerline to several polygons
roadpolygon3_cross = Polygon ([(15.28187825213209194, -2.01228281530332032), (15.22010294455350454,-2.43198986484963209), (15.62269429173659674,-2.48892698267097101), (15.57530881313466686,-2.82052765361192703), (15.17170226145202605,-2.7751943763183573), (15.13094754886597038,-3.10737516411619508), (14.58428207005195176,-3.03616281315371728), (14.63966594774528218, -2.7086026712917981), (14.27360618379699808,-2.67323583194116532), (14.34390928502602591,-2.34698095300722853), (14.69662485787589468,-2.40122488590592287), (14.77218958865512377,-1.93845918678980556), (15.28187825213209194,-2.01228281530332032)])
bigcenterline = LineString ([(14.84443668818895823,-3.11738669006782221), (15.30464440473712173,-0.27801396875802986), (17.4659367333415716 ,0.9344183131420305), (22.13116529630484308 ,2.75306673599211926), (25.39946101273108781 ,3.17478231230518126)])
roadpolygon1 = Polygon ([(14.77091062846589864 ,-1.93192974461082834), (15.28487648709744562 ,-2.00441210928963587), (15.45619843997462795, -0.436157309875429), (17.2550789451850406, 0.43363106627026493), (18.11168870957095223, 0.74991774850506321), (17.8085806390959398 ,1.6065275128909744), (15.37712676941592704, 0.42045245451048219), (15.12673314598004559, 0.09098716051590072), (14.77749993434578712 ,-1.93192974461082878), (14.77091062846589864 ,-1.93192974461082834)])
roadpolygon2 = Polygon ([(18.1455103811575853, 0.77030341357097831), (22.21440676199092934, 2.19029883068771536), (25.29820191378040306, 2.53294273644210222), (25.32455913729997121, 3.77173224186180889), (22.13533509143221423 ,3.48180278314655922), (17.85228626950238251 ,1.67633297205613552), (18.1455103811575853 ,0.77030341357097831)])
polygonlist = [roadpolygon1, roadpolygon2, roadpolygon3_cross]


#testing lines
line = LineString([(5.54984644791813331, -2.93113995998589694), (5.41443240434236017 ,-2.78049183650784926), (5.33995468037568521,-2.61460963312752703), (5.11313615738626392,-1.90368590435471829)])
polygon = Polygon([(5.0606632155006519, -1.93753941524866136), (5.17576515254005898, -1.91722730871229552), (5.42289578206584544 ,-2.71278481471996269), (5.58539263435677302 ,-2.9125205289942282), (5.5143002614794927, -2.95991544424574915), (5.34841805809917048, -2.75679437888208945), (5.24685752541734018, -2.50627839826690879), (5.0606632155006519 ,-1.93753941524866136)])

line22 = LineString([(4.98653654815829395, -7.49880555340785193), (5.01271375913349893, -5.79074253727571175), (5.47081495119959094, -5.58132484947407015), (6.64224514234002328, -5.78419823453191029), (7.02835900422430093, -6.41899560068063657)])
polygon22 = Polygon ([(4.7640302548690503, -7.45299543420124344), (4.81638467681946025, -5.79728684001951322), (5.40537192376157805, -5.37190716167242854), (6.73386538075324204, -5.58786915221787162), (7.23123238928214107 ,-6.49752723360625239), (6.81894131642265933 ,-6.53024874732525884), (6.45900466551358754, -5.91508428940793607), (5.4773592539433924, -5.699122298862493), (5.20249853870373702, -5.98052731684594896), (5.24176435516654493, -7.61660300279627478), (4.7640302548690503, -7.45299543420124344)])

#testing lines actual size
line1 = LineString ([(18.08126186824065229,-26.91177387046518632), (17.32709242893336921,-25.55790343122680852), (17.02724192896782185,-24.59474727982232523), (16.57292298962608612,-20.55130871968086126), (16.718305050215438,-16.16258776563967459)])
polygon1 = Polygon ([(17.27257415621236092,-27.148019718922896), (16.36393627752888591,-25.34891671912961186), (15.89144458061347898,-20.86024559843324511), (16.0186538836291632,-16.22619241714752292), (17.54516551981740236,-16.26253793229486178), (17.45430173194905521,-20.6058269924018731), (17.89044791371712506,-24.73104296162485127), (18.85360406512160836 ,-26.51197320384446243), (17.27257415621236092, -27.148019718922896)])

#toronto
toronto_straigth_line = LineString([(-79.26440233871521457, 43.7495077232002032), (-79.26315073033286751, 43.74651201467040096)])
toronto_straigth_polygon = Polygon ([(-79.26450083706826888, 43.74944573716769725), (-79.26438641764524107, 43.74946335648514406), (-79.26429046666342515, 43.74950920916671748), (-79.26308046534401797, 43.74658779896362404), (-79.26319891810476292, 43.74657166561269861), (-79.26325411114740405, 43.74654364452952393), (-79.26450083706826888, 43.74944573716769725)])

toronto_intersection_cross_line = LineString ([(-79.26318928685984133, 43.74657190472245105), (-79.26301379726088214, 43.74614335743337534)])
toronto_intersection_cross_polygon = Polygon ([(-79.26325334853611082, 43.74654536086538315), (-79.26320007323290895, 43.74657087298239588), (-79.26308039138987738 ,43.74658738082281673), (-79.26305534824558663, 43.74652819646315294), (-79.26304521843441364, 43.74650437264800473), (-79.26303311893776993, 43.74648645788934687), (-79.26301060824629019, 43.74646619826702221), (-79.26297796774363746, 43.74645044078297929), (-79.2629378236771629, 43.74644181168458346), (-79.26289993067985051, 43.74644293721915744), (-79.26280801202297255 ,43.74646244648510418), (-79.26279450560808471,43.74644818971383131), (-79.2627776225894678, 43.74638891155959897), (-79.2628830476612336, 43.74636377462078229), (-79.26290893495644241,43.74634989302769839), (-79.26292656833139461,43.74633338518728465), (-79.26294232581547305,43.74631162485218283), (-79.26294757831010429 ,43.74628836380432517), (-79.26294757831014692, 43.74626960489474925), (-79.26291081084735879, 43.74617843659425631), (-79.26296371097238591, 43.74615442518999942), (-79.26308376799362065, 43.74613491592404557), (-79.2631190347435961, 43.74622345797720868), (-79.26313291633668712 ,43.74624146653039247), (-79.2631749362941207 ,43.74627260632027514), (-79.26322783641909098, 43.74628386166602212), (-79.26326798048556554, 43.74628048506230016), (-79.26335464664776964, 43.74626022543996129), (-79.26336815306265748, 43.74627448221123416), (-79.26338728715042237 ,43.74633751214738453), (-79.26328486350418245 ,43.74635852212609421), (-79.26323196337921217, 43.74639266334150278), (-79.26321733142974324 ,43.74643580883351035), (-79.26321920732070225, 43.7464571939904161), (-79.26325334853611082, 43.74654536086538315)])

toronto_intersection_t_line1 =LineString ([(-79.25055019481345653, 43.7527598692136479), (-79.25016619992048561, 43.75252561260801087)])
toronto_intersection_t_line2 = LineString ([(-79.25051652835041693,43.75248800195655718), (-79.25035707045650213,43.75269000073735981)])
toronto_intersection_t_polygon =Polygon ([(-79.25050268847540735,43.75277920277897437), (-79.25049765259224444 ,43.75277550510252667), (-79.25014450688551904, 43.75255758870513034), (-79.25019155541605187, 43.75250462389231387), (-79.25020930426290988,43.75249729897139161), (-79.25028086310575759 ,43.75254350231874412), (-79.25030593687353075, 43.7525547714278531), (-79.25034143456721836,43.75255956079922015), (-79.25037580535000359, 43.75255477142784599), (-79.25040764058323361,43.75253955813055029), (-79.25042454424689709, 43.75252519001643492), (-79.25047469178244341, 43.75246771755997344), (-79.25054540544209658, 43.75250208834275867), (-79.25055864664530247, 43.75251730164006148), (-79.25047722733198441 ,43.7526073136490794), (-79.25047088845811061,43.75262900668410992), (-79.25047455091856818,43.7526484458973286), (-79.25048765125791306,43.75266703992735984), (-79.25050568183249311,43.75268112631374606), (-79.25057717024343162,43.75272458281576604), (-79.2505460393295067, 43.75275839014309298), (-79.25050268847540735 ,43.75277920277897437)])

#Cross Intersection
#cross1
linecross1case1 = LineString ([(13.30269544712790442,-7.92676305809689907), (13.59008576520061062,-15.24623522151118493)])
linecross1case1shorter = LineString ([(13.31244487825249401,-8.08693598037448425), (13.58324074750704469,-15.08936394729377994)])
linecross1case2 = LineString ([(9.61049324042597952,-11.56297354798554444), (17.25197166120115,-11.46940442446584818)])
polygoncross1 = Polygon ([(12.09957254500297452,-8.12033951025880008), (12.21782940188388977,-10.72199036163897645), (9.90727235205673828,-10.7947638120272309), (9.9254657146538019,-12.50493989615126367), (12.24511944577948697,-12.41397308316594206), (12.35427962136187219,-15.07020402233731105), (14.84677029715965446,-15.015623934546106), (14.64664330859195296,-12.41397308316594028), (17.13913398438974411,-12.43216644576300567), (17.01178044621029528,-10.74018372423604006), (14.7103200776816756,-10.7674737681316337), (14.53748313300957129,-8.15672623545292907), (12.09957254500297452,-8.12033951025880008)])
#cross1forrelatedwork
linerelatedcross = LineString ([(-17.59728470880561702,-9.42619815983996467), (-17.45599990745541419,-15.55663399342598652)])
polygonrelatedcross = Polygon ([(-18.8224888455143855,-9.51450116068381746), (-16.31468362154833329,-9.47917996034626853), (-16.20872002053568295,-11.48365807950223783), (-13.4271754939536212,-11.44833687916468357), (-13.27706039251902936,-13.61176039983962838), (-16.19988972045129216,-13.65591190026156099), (-16.13807761986058154,-15.53676581823610015), (-18.71652524450173161,-15.54559611832048738), (-18.79599794526122025,-13.69123310059910992), (-21.33029406948043771,-13.72655430093666595), (-21.40976677023992636,-11.58962168051488817), (-18.78716764517682947,-11.52780957992416866), (-18.8224888455143855,-9.51450116068381746)])
#cross2
linecross2case1 = LineString ([(-2.39375544073383217,-18.98230935645637274), (-2.42967923049292089,-23.92183044833104333)])
linecross2case2 = LineString ([(-5.54559457222641861,-21.4463170301840762), (0.70583403311589077,-21.40088513624990441)])
polygoncross2 = Polygon ([(-3.26491349673089815,-19.08385854560704331), (-1.68388358782165071,-19.06568578803337743), (-1.71120343531114294,-20.11390873386767097), (0.6604021391817172,-20.06518745458520314), (0.62384289902961143,-22.80819296579930722), (-1.71120343531114383,-22.80819296579930722), (-1.69296996660848276,-23.75425724204011146), (-3.32851814823873848,-23.78151637840061738), (-3.33675492190989909,-22.83513580811862198), (-5.58194008737375746,-22.82744660578296703), (-5.47290354193174,-20.18331037881405621), (-3.29185018471103774,-20.16779441850630405), (-3.26491349673089815,-19.08385854560704331)])

linesmall1 = LineString ([(-2.86056964071674358,-24.9320790922835549), (-2.69701482255371738,-27.94648525481598256)])
linesmall2 = LineString ([(-4.32347662539713795,-26.31093707318572683), (-1.1250712924313051,-26.16555501259636785)])
polygonsmall = Polygon ([(-3.28308625430455781,-24.9354864843286208), (-3.28308625430455781,-25.5079283478992096), (-4.31893343600371971,-25.53518748425971552), (-4.27350154206954613,-27.24342669618464896), (-3.23765436037038379,-27.17982204467680418), (-3.20130884522304537,-27.8613004536894131), (-2.06551149686870072,-27.83404131732890718), (-2.16546166352388347,-27.21616755982414304), (-1.00240517880903468,-27.19799480225047716), (-1.31134205756141675,-25.45341007517820131), (-2.32901648168690922,-25.49884196911237666), (-2.38353475440791751,-24.95365924190229023), (-3.28308625430455781,-24.9354864843286208)])

#road wider in the middle
line01 = LineString ([(27.97756356371555952,-13.46800762843630039), (27.851830299558749,-8.73504832767638995), (27.73507798284170889,-6.90293504996287588), (27.42972576988945832,-4.31642218730850402)])
polygon01 = Polygon ([(27.13335450437698171,-4.41521260914599623), (27.70813514052239768,-4.48706018866417278), (28.15718251251100668,-7.00172547180036897), (28.40864904082462772,-7.89083926833780858), (28.7319631486564262,-9.05836243550818665), (28.53438230498143824,-9.9205333897263106), (28.24699198690872493,-10.54021876307058747), (28.35476335618599109,-13.41412194379766731), (27.58240187636558716,-13.41412194379766731), (27.5644399814860428,-10.36059981427514387), (27.06150692485880427,-9.30084801638203373), (27.16927829413607043,-7.55854421306624058), (27.25908776853379223,-7.07357305131854552), (27.13335450437698171,-4.41521260914599623)])

#T intersections
line_t_intersection_maincase = LineString ([(8.66947714110238543,-43.01141733405090406), (8.70482883356991266,-33.29310929752550408)])
line_t_intersection_case1 = LineString ([(3.23468682922685868,-34.90523165884595613), (14.6204873478049695,-34.73060281653646086)])
line_t_intersection_case2 = LineString ([(20.68791678271384527 ,-35.05544085816579525), (32.00727315641323401, -34.90097241878960688)])
polygon_t_intersection_case1_and_maincase = Polygon ([(3.21481037563063143,-36.32753388832265529), (3.30567416349897858,-33.36537440381452768), (14.54098153342012978,-33.3017697523066829), (14.6136725637148075,-36.20941096409380577), (9.70702801882404742,-36.20941096409380577), (9.82969413244632761,-42.90607212999100994), (7.2491625569852598, -42.92424488756468293), (7.17647152669058208 ,-36.30936113074898941), (3.21481037563063143,-36.32753388832265529)])
polygon_t_intersection_case2 = Polygon ([(22.71872244157140841 ,-33.44260862350260766), (31.87779225870083266, -33.36991759320792994), (32.09586534958486936 ,-36.71370498676311911), (27.54468179831361496 ,-36.71577835034961623), (27.71326607833841749, -39.31946889739933226), (25.2032334646358116, -39.24454255072163988), (25.03464918461100908 ,-36.84689945703556901), (20.73334867664802061, -36.7455073125170486), (20.78786694936903245, -33.40171991896185943), (22.71872244157140841 ,-33.44260862350260766)])